# Cross - 美诺福业务管理系统

## 基础资料

* 厂商 - 维保仪器设备的生产厂商
  - 编号
  - 名称

* 客户
  - 编号
  - 名称
  - 作业区
    - 作业区名称
  
* 设备类型 - 维保仪器设备的特定分类
  
* 设备 - 维保服务所涉及的仪器设备的类型及其规格定义
  
  - 名称 - 
  - 型号 - 设备厂商所给定的型号编码
  - 厂商 - 生产厂商，缺省为美诺福
  - 类型 - 设备类型
  - 编号 - 可选，任何便于标识的统一编码
  - 标签 
  - 图片
  - 备注
  
* 维保设备 - 由客户指定的需进行维保的仪器设备
  - 所属公司（客户）
  - 设备
  - 设备序列号
  - 作业区
  - 安装地点
  - 状态 - 草稿/启用/停用
  - 负责人
  - 权重（重要性）
  - 标签 
  - 图片
  - 备注
  
* 设备检修标准

* 维保技术服务站
  - 名称 - 必需，维保技术服务站名称，唯一
  - 缩写 - 可选
  - 站长 - 
  - 服务公司 - 服务公司名称
  - Logo
  - 创建人
  - 创建日期
  - 更新日志
    - 操作人
    - 更新日期
    - 操作
  

* 巡检
  - 期间 - 巡检开始和完成时间
    - 开始时间
    - 完成时间
  - 设备 - 本次巡检的设备
  - 检测明细
    - 检测部位
    - 检测值
    - 是否通过检测
  - 检测人
  - 审核 ？
  
## 角色

* 维修技术部经理
* 维修站长
* 维修工程师


### 用户

用户是一个特定的系统使用者（可以是人或设备、软件系统等），具有一个面向系统整体的统一身份。一个用户可以跨子系统拥有多个账号，每一个用户账号都对应于一个特定子系统的特定的业务角色（拥有一组相应的业务职责权限），该用户无论拥有多少账号，其统一身份是唯一的，统一身份的唯一标识由系统自动产生。

系统启用HR后，统一身份可以同一个员工相关联，以便对员工进行整体工作评估。

#### 注册用户账号

注册新的用户账号时，用户向系统提供以下信息：

* 推荐人 - 可选项，账号注册完成后，推荐人负责审核并为其分配业务角色
* 用户账号 - 必需且唯一，账号登录标识
* 姓名
* 密码 - 6位以上数字和字母组合，不能是纯数字
* 员工编号 - 使统一身份同员工相关联
* 手机
* 头像
* 邮箱

系统创建用户账号成功后，用户可以该账号登录，如果有推荐人，系统将通知该推荐人用户账号注册成功。

如果用户是在已有账号下注册新的用户账号，则系统将已有账号同新建账号通过统一身份相互关联。

用户可以在已有账号下随时修改当前账号信息，包括姓名、密码、手机、邮箱、头像等。如果当前账号为游客（未分配任何业务角色），则用户可以注销当前账号。


### 系统管理员

系统管理员用于分配各子系统主管权限（子系统其它业务角色均由该子系统业务主管指定），而并不涉及任何具体的业务操作。其中，缺省系统管理员为系统预设的系统管理员，用于系统实际启用后指定首位系统管理员，一旦有系统管理员被指定，该缺省系统管理员将自动失效，系统将保持至少一位系统管理员。

#### 指定首位维修技术部经理

缺省系统管理员可以指定一个尚未分配业务角色的用户账户为首位维修技术部经理，指定维修技术部经理后，缺省系统管理员账号失效。



## 业务概要

**维保技术服务系统**从总体上致力于为客户提供细致、稳定、及时的仪器设备维护、保障及维修服务，在业务不断成长的同时努力降低营运成本、保障安全、提高整体效率。

### **维修技术部经理**
**维修技术部经理**是维保技术服务系统的业务主管（或区域业务分管），其主要业务职责包括：

* 指定其他维修技术部经理，或回收其他（不包括自己）维修技术部经理权限
* 维护所有维保技术服务站基础资料
* 指定维保技术服务站站长，或回收站长权限
* 分配或回收专业组组长角色权限

维修技术部经理可以创建新的维保技术服务站，创建时向系统提供所建服务站的基本信息，主要包括：

* 名称 - 必需，维保技术服务站名称，唯一
* 缩写 - 可选
* 站长 - 

维修技术部经理可以随时修改维保技术服务站名称、缩写等基本信息，指定新的站长，或回收原站长权限。

维修技术部经理可以指定一个或多个专业组长，或回收专业组长的业务权限。

### **专业组**

专业组负责提供专业技术信息，包括仪器设备技术规格、维保标准、维修技术指导、技术培训等。专业组分为专业组长、专业工程师两组业务角色，专业组长除含盖专业工程师的职责外，还具有技术审核的职责。

为了便于设备管理，统一各种设备的厂商信息，专业组需负责向系统提供并维护所有设备所涉及的生产厂商信息，内容包括：

  * 编号 - 可选，任何便于标识的统一编码
  * 名称 - 生产厂商名称
  
专业组成员负责向系统提供所有预设设备类型，主要内容包括：
  * 名称 - 设备类型名称
  * 巡检周期 - 每年巡检次数，缺省值为每周一次 
  * 巡检工时 - 每次巡检所占工时 
  * 点检周期 - 每年点检次数，缺省值为每月一次
  * 点检工时 - 每次点检所占工时
  * 维护周期 - 每年维护保养次数，缺省值为每年2次
  * 维护工时 - 每次维护所占工时
  * 维修周期 - 每年维修次数，缺省值为每年2次
  * 维修工时 - 每次维修所占工时
  

专业组成员负责向系统提供所有仪器设备基本信息、检测标准、点巡检周期、以及相关技术资料，包括：

  * 编号 - 可选，任何便于标识的统一编码
  * 名称 - 
  * 型号 - 设备厂商所给定的型号编码
  * 厂商 - 生产厂商，缺省为美诺福
  * 类型 - 设备类型
  * 等级 -
  * 检测标准
    * 项目 - 检测项目或检测部位表述
    * 标准 - 检测指标及其标准值或范围
    * 说明
  * 巡检周期 - 每年巡检次数，缺省值为设备类型中所设定的巡检周期（每周一次） 
  * 巡检工时 - 每次巡检所占工时，缺省值为设备类型中所设定的巡检工时 
  * 点检周期 - 每年点检次数，缺省值为设备类型中所设定的点检周期（每月一次）
  * 点检工时 - 每次点检所占工时，缺省值为设备类型中所设定的点检工时
  * 维护周期 - 每年维护保养次数，缺省值为设备类型中所设定的维护周期（每年2次）
  * 维护工时 - 每次维护所占工时，缺省值为设备类型中所设定的维护工时
  * 维修周期 - 每年维修次数，缺省值为设备类型中所设定的维修周期（每年2次）
  * 维修工时 - 每次维修所占工时，缺省值为设备类型中所设定的维修工时
  * 技术资料
    * 标题
    * 文档 - 任何可以上载的文档、多媒体文件等
    * 提供者
  * 标签 -
  * 图片 -
  * 备注 -


### **站长**
系统将为站长产生巡检和点检计划：巡检每周一次，点检每月一次，每年两次维护，每年两次维修。

## 问题
* 在巡检时如果某个检测部位未达检测标准，这时检测人员作什么操作？
* 点巡检记录审核是何含义？ 是否需要专门审核？有审核不通过的情况？
* 安装地点同作业区有何区别？区分作业区和安装地点有何作用？
* 多个甲方单位拥有同种设备的情况是否普遍？同种设备是否具有相同的巡检和点检标准？
* 除了点检周期，点检计划的产生依据还有哪些？

## 系统安装
假设安装目录为: /home/jsmtest/apps

Clone cross：

```
git clone -b docker-deploy-test https://github.com/JSMetta/cross.git
cd cross
git pull origin dev

git clone -b vcross-1.0.1 https://github.com/JSMetta/VCross.git
cd VCross
git pull origin vcross-1.0.1

cd ..

docker-compose up --build -d

```
cross项目在/home/jsmtest/apps/cross中


## 常用命令

cd /home/jsmtest/apps/cross
git pull origin docker-deploy-test
docker build -t jsmetta/cross .
docker run -d --name redis -p 6379:6379 redis

docker run --name mongodb --restart unless-stopped -v /home/mongo/data:/data/db -v home/mongo/backups:/backups -d mongo --smallfiles

docker run -d -p 8089:8080 --link redis:redis --name cross jsmetta/cross

docker run -it --link mongodb:mongo --rm mongo mongo --host mongo test

docker run -d --name nginx -p 80:80 --link cross:cross cross/nginx

docker-compose up --build

docker exec -it mongodb mongo

#### Remove dangling images
docker images -f dangling=true

docker images purge

#### 备份数据库

脚本文件：/home/mongo/dailybackup.sh

shudo crontab -e
